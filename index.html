<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>首爾之旅 2025</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #f4f4f7; --card-bg: #ffffff; --primary: #5b6c7d; --accent: #c4a484;
            --text-main: #333333; --text-sub: #888888;
            --tag-food: #e8f5e9; --tag-food-text: #2e7d32;
            --tag-shop: #fff3e0; --tag-shop-text: #ef6c00;
            --tag-other: #e3f2fd; --tag-other-text: #1565c0;
            --shadow: 0 2px 12px rgba(0,0,0,0.04); --radius: 16px;
            --bottom-nav-height: 80px;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html, body { height: 100%; margin: 0; padding: 0; }
        body { font-family: 'Noto Sans TC', sans-serif; background:var(--bg-color); color:var(--text-main); padding-bottom: calc(var(--bottom-nav-height) + 30px); }
        header { background:var(--card-bg); padding:20px; position:sticky; top:0; z-index:100; box-shadow:0 1px 5px rgba(0,0,0,0.02); text-align:center; }
        h1 { margin:0; font-size:1.4rem; font-weight:700; letter-spacing:1px; }
        .subtitle { font-size:0.85rem; color:var(--text-sub); margin-top:5px; }
        .tabs { display:flex; gap:15px; overflow-x:auto; padding:10px 20px; scrollbar-width:none; background:var(--card-bg); border-bottom:1px solid #eee; }
        .tabs::-webkit-scrollbar { display:none; }
        .tab-btn { padding:8px 16px; border-radius:20px; border:1px solid #eee; background:var(--card-bg); color:var(--text-sub); font-size:0.9rem; white-space:nowrap; cursor:pointer; transition:all .3s; flex-shrink:0; }
        .tab-btn.active { background:var(--primary); color:#fff; border-color:var(--primary); box-shadow:0 4px 10px rgba(91,108,125,.3); }
        .section { display:none; padding:20px; animation:fadeIn .3s ease; }
        .section.active { display:block; }
        .weather-widget { display:flex; align-items:center; justify-content:space-between; background:linear-gradient(135deg,#a8c0ff,#3f2b96); color:white; padding:15px; border-radius:var(--radius); margin-bottom:20px; font-size:0.9rem; }
        .timeline-item { position:relative; padding-left:20px; margin-bottom:20px; border-left:2px solid #ddd; }
        .timeline-item::before { content:''; position:absolute; left:-6px; top:0; width:10px; height:10px; border-radius:50%; background:var(--primary); }
        .time-label { font-size:0.85rem; font-weight:700; color:var(--primary); margin-bottom:5px; }
        .card { background:var(--card-bg); border-radius:var(--radius); padding:15px; box-shadow:var(--shadow); margin-top:5px; }
        .card-title { font-weight:600; font-size:1.1rem; margin-bottom:8px; display:flex; align-items:center; gap:8px; }
        .card-desc { font-size:0.9rem; line-height:1.6; color:var(--text-sub); margin-bottom:10px; }
        .card-desc a { color: #4285F4; text-decoration: none; }
        .tag { display:inline-block; padding:4px 8px; border-radius:6px; font-size:0.75rem; font-weight:500; margin-right:5px; margin-bottom:5px; }
        .tag.food { background:var(--tag-food); color:var(--tag-food-text); }
        .tag.shop { background:var(--tag-shop); color:var(--tag-shop-text); }
        .tag.other { background:var(--tag-other); color:var(--tag-other-text); }
        .highlight { color:var(--accent); font-weight:600; border-bottom:1px dashed var(--accent); }
        .btn-nav { display:inline-flex; align-items:center; gap:6px; background:#f0f2f5; color:var(--text-main); padding:10px 14px; border-radius:8px; text-decoration:none; font-size:0.9rem; font-weight:500; margin:8px 8px 8px 0; min-width:120px; justify-content:center; }
        .btn-nav i { color:#4285F4; }
        .btn-naver { display:inline-flex; align-items:center; gap:6px; background:#03c75a; color:white; padding:10px 14px; border-radius:8px; text-decoration:none; font-size:0.9rem; font-weight:500; margin:8px 8px 8px 0; min-width:120px; justify-content:center; }
        .btn-naver i { color:white; }
        .btn-ticket { display:inline-flex; align-items:center; gap:6px; background:#ff5a5f; color:white; padding:10px 14px; border-radius:8px; text-decoration:none; font-size:0.9rem; font-weight:500; margin:8px 8px 8px 0; min-width:140px; justify-content:center; }
        .intro-link { display:block; margin:8px 0; font-size:0.9rem; color:#4285F4; }
        .souvenir { display:block; margin:8px 0; font-size:0.9rem; color:var(--accent); font-weight:500; }
        .info-grid { display:grid; grid-template-columns:1fr; gap:15px; }
        .info-box { background:white; padding:15px; border-radius:var(--radius); box-shadow:var(--shadow); }
        .expense-input { width:100%; padding:12px; margin-bottom:10px; border:1px solid #eee; border-radius:8px; }
        .btn-primary { width:100%; padding:12px; background:var(--primary); color:white; border:none; border-radius:8px; font-size:1rem; cursor:pointer; }
        .expense-list { margin-top:20px; list-style:none; padding:0; }
        .expense-item { display:flex; justify-content:space-between; align-items:center; padding:12px 0; border-bottom:1px solid #eee; }
        .total-block { margin-top:20px; border-top:1px solid #eee; padding:15px; background:#f8f9fa; border-radius:12px; }
        .bottom-nav { position:fixed; bottom:0; left:0; width:100%; height:var(--bottom-nav-height); background:white; display:flex; justify-content:space-around; box-shadow:0 -2px 10px rgba(0,0,0,0.05); border-top:1px solid #f0f0f0; z-index:200; }
        .nav-item { text-align:center; color:#aaa; font-size:0.7rem; cursor:pointer; flex:1; padding:15px 0; }
        .nav-item.active { color:var(--primary); }
        .nav-item i { font-size:1.3rem; display:block; margin-bottom:4px; }
        .alert { background:#fff3cd; color:#856404; padding:15px; border-radius:var(--radius); border:1px solid #ffeaa7; margin:15px 0; font-weight:500; text-align:center; }
        .luggage-list { list-style:none; padding:0; margin:20px 0; }
        .luggage-list li { margin:10px 0; padding-left:30px; position:relative; font-size:1rem; }
        .luggage-list li input { position:absolute; left:0; top:4px; transform:scale(1.5); }
        .luggage-list li label { cursor:pointer; }
        
        .btn-google-drive { display:inline-flex; align-items:center; gap:8px; background:#1FA463; color:white; padding:12px 20px; border-radius:50px; text-decoration:none; font-weight:bold; margin-top:15px; box-shadow: 0 4px 10px rgba(31, 164, 99, 0.3); }

        @keyframes fadeIn { from { opacity:0; transform:translateY(5px); } to { opacity:1; transform:translateY(0); } }
    </style>
</head>
<body>
<header>
    <h1>Seoul Trip 2025</h1>
    <div class="subtitle">12月25日 - 12月28日 (4天3夜)</div>
    <div class="tabs" id="dayTabs"></div>
</header>
<div id="content-container"></div>

<nav class="bottom-nav">
    <div class="nav-item active" onclick="switchView('itinerary',this)">
        <i class="fa-solid fa-map-location-dot"></i> 行程
    </div>
    <div class="nav-item" onclick="switchView('info',this)">
        <i class="fa-solid fa-info-circle"></i> 資訊
    </div>
    <div class="nav-item" onclick="switchView('expense',this)">
        <i class="fa-solid fa-wallet"></i> 記帳
    </div>
</nav>

<script>
// ========= 您的 Google Drive 連結 =========
const ALBUM_LINK = "https://drive.google.com/drive/folders/1xdc5mTKFMI1tez06zt_IzPR9HNLg9oCv?usp=sharing"; 
// ==========================================

const itineraryData = [
    {day:"Day 1",date:"12/25 (四)",weather:"晴時多雲 -2°C / 5°C",events:[
        {time:"07:20",title:"建議集合時間",icon:"fa-clock",desc:"<strong class='highlight'>松山機場國際線報到櫃檯集合</strong><br>（起飛前2小時報到，建議提早到達辦理）",nav:""},
        {time:"09:20",title:"航班 CI260 出發",icon:"fa-plane-departure",desc:"TSA 松山 → GMP 金浦 (飛行約2小時25分)<br><a href='https://www.google.com/travel/flights' target='_blank'>Google Flights 即時查詢</a>",nav:""},
        {time:"13:00",title:"抵達 & 飯店 Check-in",icon:"fa-hotel",desc:"首爾金浦機場 → 明洞中城飯店 / 東大門民宿 (地鐵)",nav:"Hotel Midcity Myeongdong"},
        {time:"14:00",title:"明洞換錢 & 會合",icon:"fa-money-bill-wave",desc:"麥克4人先到明洞換錢 → 搭地鐵到東大門歷史文化公園站與敬仁4人會合",nav:"Myeongdong Money Exchange"},
        {time:"15:00",title:"東大門晚午餐",icon:"fa-utensils",tags:["必吃"],desc:"鬼怪烤肉 (서울 중구 을지로43길 38)<br>滿足五香豬腳 (서울 중구 을지로43길 9-4 1~3층, 15:00開始營業)<br><span class='souvenir'>伴手禮建議：東大門批發市場小物、服飾配件</span>",nav:"서울 중구 을지로43길"},
        {time:"16:30",title:"江南巡禮",icon:"fa-bag-shopping",tags:["打卡"],desc:"星空圖書館 / COEX MALL (三成站 6號出口)<br>樂天百貨 / 樂天世界塔 (蠶室站 1/2號或10/11號出口)<br><a href='https://www.klook.com/zh-TW/activity/17678-lotte-world-tower-seoul-sky/' target='_blank' class='btn-ticket'>Klook 樂天世界塔觀景台門票</a><br><a href='https://www.klook.com/zh-TW/activity/33305-lotte-world-aquarium-seoul/' target='_blank' class='btn-ticket'>Klook 樂天水族館門票</a><br><a href='https://www.kkday.com/zh-tw/blog/31400/asia-korea-seoul-coex-mall' target='_blank' class='intro-link'>COEX & 星空圖書館部落格介紹</a><br><a href='https://www.kkday.com/zh-tw/blog/32358/asia-korea-seoul-lotte-world-tower' target='_blank' class='intro-link'>樂天世界塔歷史與打卡介紹</a><br><span class='souvenir'>伴手禮建議：Olive Young美妝、韓國零食、藥菓</span>",nav:"Starfield Library COEX"},
        {time:"19:30",title:"晚餐",icon:"fa-fire-burner",tags:["必吃"],desc:"夢村炒辣雞 (서울 송파구 석촌호수로 298, 11:30-21:00 Break 15:00-17:30)<br>或 外固執雪濃湯 (555 Samseong-ro, Gangnam District)",nav:"몽촌닭갈비 석촌호수로"}
    ]},
    {day:"Day 2",date:"12/26 (五)",weather:"多雲 -4°C / 3°C",note:"包車服務 10:00~19:30 (Henry)",events:[
        {time:"10:00",title:"包車接送 & 早午餐",icon:"fa-van-shuttle",desc:"Henry到東大門民宿接敬仁4人 → 明洞中城飯店接麥克4人 → 望遠市場<br>Uirak天婦羅 (411-21 Mangwon-dong)<br><a href='https://www.kkday.com/zh-tw/blog/29966/asia-korea-seoul-mangwon-market' target='_blank' class='intro-link'>望遠市場美食部落格介紹</a><br><span class='souvenir'>伴手禮建議：傳統市場小吃、韓式醬料</span>",nav:"우이락 망원"},
        {time:"14:00",title:"前往醫院",icon:"fa-hospital",desc:"送敬仁2人到 Korea Cancer Center Hospital (75 Nowon-ro, Nowon-gu)",nav:"원자력병원 Nowon"},
        {time:"14:00",title:"逛街 & ZOOLUNG",icon:"fa-otter",desc:"昌信洞文具玩具批發市場 → 時代廣場 ZOOLUNG (下午茶 Henry推薦)<br><a href='https://www.klook.com/zh-TW/activity/78156-seoul-zoolung-zoolung-indoor-animal-theme-park/' target='_blank' class='btn-ticket'>Klook ZOOLUNG門票</a><br><a href='https://www.kkday.com/zh-tw/product/32291' target='_blank' class='btn-ticket'>KKday ZOOLUNG門票</a><br><a href='https://www.kkday.com/zh-tw/blog/29966/asia-korea-seoul-changsin-dong' target='_blank' class='intro-link'>昌信洞文具街部落格介紹</a><br><span class='souvenir'>伴手禮建議：韓國可愛文具、玩具</span>",nav:"Zoolung Zoolung Yeongdeungpo"},
        {time:"19:30",title:"晚餐：櫸樹雪濃湯",icon:"fa-bowl-food",tags:["暖胃"],desc:"느티나무설렁탕 (서울 중구 퇴계로71길 38)",nav:"느티나무설렁탕 동대문"}
    ]},
    {day:"Day 3",date:"12/27 (六)",weather:"晴天 -3°C / 4°C",note:"包車服務 10:00~19:00 (Henry)",events:[
        {time:"10:00",title:"包車接送",icon:"fa-van-shuttle",desc:"Henry到明洞飯店接麥克4人 → 東大門民宿接敬仁4人",nav:""},
        {time:"11:00",title:"聖水洞逛街吃點心",icon:"fa-camera",tags:["打卡"],desc:"聖水洞逛街吃點心<br><a href='https://www.kkday.com/zh-tw/blog/31400/asia-korea-seoul-seongsu-yeok' target='_blank' class='intro-link'>聖水洞文青咖啡街部落格介紹</a><br><span class='souvenir'>伴手禮建議：香氛、選物店手作商品</span>",nav:"성수동 서울"},
        {time:"13:00",title:"北村韓屋村 & 益善洞午餐",icon:"fa-mug-hot",tags:["文青","咖啡"],desc:"北村韓屋村 → 益善洞逛街吃午餐<br>土俗村蔘雞湯 (5 Jahamun-ro 5-gil)<br>鐘路老奶奶刀削麵 / 新羅製麵<br><a href='https://www.kkday.com/zh-tw/blog/142854/asia-korea-seoul-bukchon-hanok-village' target='_blank' class='intro-link'>北村韓屋村歷史介紹部落格</a><br><a href='https://jamesdiscover.tw/blog/17403' target='_blank' class='intro-link'>益善洞韓屋村打卡部落格</a><br><span class='souvenir'>伴手禮建議：傳統韓菓、手工藝品</span>",nav:"토속촌 삼계탕"},
        {time:"14:30",title:"東大門 SPAREX 汗蒸幕",icon:"fa-spa",tags:["放鬆"],desc:"東大門Sparex汗蒸房 (247 Jangchungdan-ro)<br>Wendy脫隊去明洞剪頭髮<br>傍晚清溪川看燈飾 (麥克2人脫隊)<br><a href='https://www.klook.com/zh-TW/activity/133675-seoul-dongdaemun-sparex-jjimjilbang-sauna-admission-ticket/' target='_blank' class='btn-ticket'>Klook SPAREX門票</a><br><a href='https://www.kkday.com/zh-tw/product/251827' target='_blank' class='btn-ticket'>KKday SPAREX門票</a><br><a href='https://www.kkday.com/zh-tw/blog/29966/asia-korea-seoul-dongdaemun-sparex' target='_blank' class='intro-link'>SPAREX汗蒸幕體驗部落格</a>",nav:"동대문 스파렉스"},
        {time:"18:00",title:"晚餐：山清炭火花園",icon:"fa-fire-flame-curved",tags:["必吃","排隊"],desc:"4大+2小 山清炭火花園烤肉乙支路店 (16-3 Eulji-ro 14-gil)<br>或 청기와타워 을지로점 (서울 중구 을지로2가 199-21)<br>吃完逛明洞商圈/夜市後自行回飯店&民宿",nav:"산청숯불가든 을지로"}
    ]},
    {day:"Day 4",date:"12/28 (日)",weather:"多雲 -2°C / 6°C",events:[
        {time:"11:00",title:"Check-out & 早餐",icon:"fa-suitcase-rolling",desc:"明洞或南大門市場刀削麵巷早餐<br><span class='souvenir'>伴手禮建議：南大門魷魚絲、果乾、傳統零食</span>",nav:"남대문 칼국수 골목"},
        {time:"11:45",title:"機場會合",icon:"fa-handshake",desc:"<strong class='highlight'>金浦機場國際線報到櫃檯集合</strong><br>（起飛前2小時報到，建議11:45到達辦理）",nav:"Gimpo International Airport"},
        {time:"13:45",title:"航班 CI261 起飛",icon:"fa-plane-up",desc:"GMP 金浦 → TSA 松山 (預計15:30抵達)<br><a href='https://www.google.com/travel/flights' target='_blank'>Google Flights 即時查詢</a>",nav:""}
    ]}
];

function renderItinerary(){
    const c=document.getElementById('content-container'),t=document.getElementById('dayTabs');
    c.innerHTML='';t.innerHTML='';
    const iv=document.createElement('div');iv.id='view-itinerary';iv.className='section active';
    itineraryData.forEach((d,i)=>{
        const tab=document.createElement('button');tab.className=`tab-btn ${i===0?'active':''}`;tab.textContent=d.day;
        tab.onclick=()=>switchTab(i);t.appendChild(tab);
        const day=document.createElement('div');day.className='day-content';day.id=`day-${i}`;day.style.display=i===0?'block':'none';
        
        let icon='fa-cloud-sun';if(d.weather.includes('晴'))icon='fa-sun';if(d.weather.includes('多雲'))icon='fa-cloud';
        
        day.innerHTML=`<div class="weather-widget"><div>${d.date}</div><div><i class="fa-solid ${icon}"></i> ${d.weather}</div></div>
                       ${d.note?`<div style="margin-bottom:15px;color:var(--primary);font-weight:bold;"><i class="fa-solid fa-circle-exclamation"></i> ${d.note}</div>`:''}`;
        
        d.events.forEach(e=>{
            let tags='';if(e.tags)e.tags.forEach(g=>{let cl='other';if(['必吃','小吃','暖胃','經典','排隊','放鬆'].includes(g))cl='food';if(['打卡','文青','咖啡','伴手禮'].includes(g))cl='shop';tags+=`<span class="tag ${cl}">${g}</span>`;});
            
            const googleBtn = e.nav ? `<a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.nav)}" target="_blank" class="btn-nav"><i class="fa-solid fa-location-arrow"></i> Google</a>` : '';
            const naverBtn = e.nav ? `<a href="https://map.naver.com/v5/search/${encodeURIComponent(e.nav)}" target="_blank" class="btn-naver"><i class="fa-solid fa-location-dot"></i> Naver</a>` : '';
            
            day.innerHTML+=`<div class="timeline-item"><div class="time-label">${e.time}</div><div class="card">
                <div class="card-title"><i class="fa-solid ${e.icon}"></i> ${e.title}</div><div style="margin-bottom:8px;">${tags}</div>
                <div class="card-desc">${e.desc}</div>
                <div style="margin-top:10px;">${googleBtn}${naverBtn}</div>
                </div></div>`;
        });
        iv.appendChild(day);
    });
    c.appendChild(iv);

    // 資訊頁
    const info=document.createElement('div');info.id='view-info';info.className='section';
    info.innerHTML=`
        <div class="alert">去程 CI260 (09:20起飛) → 建議 <strong>07:20 松山機場集合</strong>（提前2小時報到）<br>回程 CI261 (13:45起飛) → 建議 <strong>11:45 金浦機場集合</strong>（提前2小時報到）</div>
        
        <h2 style="font-size:1.2rem;margin:15px 0;">Google Drive 相簿</h2>
        <div class="info-box" style="text-align:center;">
            <p style="font-size:0.95rem;line-height:1.6;color:#555;margin-bottom:15px;">
                照片影片不需壓縮，且不會過期！<br>大家可以上傳，也可以一鍵下載全部。
            </p>
            <a href="${ALBUM_LINK}" target="_blank" class="btn-google-drive" style="width:100%;justify-content:center;">
                <i class="fa-brands fa-google-drive"></i> 打開 Google Drive 相簿
            </a>
            <div style="font-size:0.8rem;color:#999;margin-top:15px;">
                建議使用 Google Drive App 操作最方便
            </div>
        </div>

        <h2 style="font-size:1.2rem;margin-bottom:15px;margin-top:25px;">航班即時查詢</h2>
        <div class="info-grid">
            <div class="info-box">
                <div class="info-label">去程 CI260（12/25）</div>
                <a href="https://www.google.com/travel/flights" target="_blank" class="btn-nav" style="width:100%;justify-content:center;">Google Flights 去程</a>
            </div>
            <div class="info-box">
                <div class="info-label">回程 CI261（12/28）</div>
                <a href="https://www.google.com/travel/flights" target="_blank" class="btn-nav" style="width:100%;justify-content:center;">Google Flights 回程</a>
            </div>
        </div>

        <h2 style="font-size:1.2rem;margin:25px 0 15px;">航班與行李</h2>
        <div class="info-grid">
            <div class="info-box"><div class="info-label">去程 CI260</div><div class="info-value">12/25 09:20 TSA → 12:45 GMP</div></div>
            <div class="info-box"><div class="info-label">回程 CI261</div><div class="info-value">12/28 13:45 GMP → 15:30 TSA</div></div>
            <div class="info-box">
                <a href="https://www.tsa.gov.tw/" target="_blank" class="btn-nav" style="width:100%;justify-content:center;">松山機場行李轉盤</a>
            </div>
            <div class="info-box">
                <a href="https://www.airport.co.kr/gimpo/extra/arrival/arrivalList.do" target="_blank" class="btn-nav" style="width:100%;justify-content:center;">金浦機場行李轉盤</a>
            </div>
        </div>

        <h2 style="font-size:1.2rem;margin:25px 0 15px;">住宿資訊</h2>
        <div class="info-grid">
            <div class="info-box"><div class="info-label">Hotel Midcity Myeongdong</div><div class="info-value" style="font-size:0.9rem">30 Dadong-gil, Jung District</div>
                <a href="https://www.google.com/maps/search/?api=1&query=Hotel+Midcity+Myeongdong" target="_blank" class="btn-nav">Google</a>
                <a href="https://map.naver.com/v5/search/Hotel%20Midcity%20Myeongdong" target="_blank" class="btn-naver">Naver</a></div>
            <div class="info-box"><div class="info-label">Airbnb (東大門民宿)</div><div class="info-value" style="font-size:0.9rem">45-4 Jangchungdan-ro 8-gil</div>
                <a href="https://www.google.com/maps/search/?api=1&query=45-4+Jangchungdan-ro+8-gil" target="_blank" class="btn-nav">Google</a>
                <a href="https://map.naver.com/v5/search/45-4%20Jangchungdan-ro%208-gil" target="_blank" class="btn-naver">Naver</a></div>
        </div>

        <h2 style="font-size:1.2rem;margin:25px 0 15px;">建議行李清單</h2>
        <div class="info-box">
            <ul class="luggage-list" id="luggage-list">
                <li><input type="checkbox" id="lug1"><label for="lug1">護照 / 機票 / K-ETA</label></li>
                <li><input type="checkbox" id="lug2"><label for="lug2">厚外套、防風衣、手套、圍巾、毛帽</label></li>
                <li><input type="checkbox" id="lug3"><label for="lug3">充電器、行動電源、韓國轉接頭（C/F型）</label></li>
                <li><input type="checkbox" id="lug4"><label for="lug4">現金 / 信用卡 / T-money交通卡</label></li>
                <li><input type="checkbox" id="lug5"><label for="lug5">常備藥、感冒藥、腸胃藥</label></li>
                <li><input type="checkbox" id="lug6"><label for="lug6">保暖貼、暖寶寶</label></li>
                <li><input type="checkbox" id="lug7"><label for="lug7">汗蒸幕換洗衣物</label></li>
                <li><input type="checkbox" id="lug8"><label for="lug8">相機 / 手機備用電池</label></li>
            </ul>
        </div>

        <h2 style="font-size:1.2rem;margin:25px 0 15px;">Google Maps 收藏清單</h2>
        <div class="info-box">
            <a href="https://reurl.cc/5bMNjM" target="_blank" style="text-decoration:none;color:var(--primary);font-weight:bold;display:block;padding:15px;text-align:center;background:#f0f2f5;border-radius:8px;">開啟完整收藏地圖</a>
        </div>
        <div style="height:100px;"></div>`;
    c.appendChild(info);

    const exp=document.createElement('div');exp.id='view-expense';exp.className='section';
    exp.innerHTML=`<div style="background:white;padding:20px;border-radius:16px;box-shadow:var(--shadow);">
        <h3 style="margin-top:0;">快速記帳 (KRW → TWD)</h3>
        <input type="text" id="exp-desc" class="expense-input" placeholder="項目"><input type="number" id="exp-amount" class="expense-input" placeholder="金額 (韓幣)">
        <button class="btn-primary" onclick="addExpense()">新增支出</button>
        <ul id="expense-list" class="expense-list"></ul>
        <div class="total-block">
            <div style="display:flex;justify-content:space-between;align-items:flex-end;">
                <span style="font-size:0.9rem;color:#666;">總計 (KRW)</span>
                <span style="font-size:1.2rem;font-weight:bold;">₩<span id="total-krw">0</span></span>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:flex-end;margin-top:5px;padding-top:5px;border-top:1px dashed #ddd;">
                <span style="font-size:0.9rem;color:#5b6c7d;">約合台幣</span>
                <span style="font-size:1.1rem;color:#5b6c7d;font-weight:bold;">NT$<span id="total-twd">0</span></span>
            </div>
        </div>
        <button onclick="copyExpenses()" style="margin-top:15px;background:transparent;color:#666;border:1px solid #ccc;padding:8px;width:100%;border-radius:8px;">複製到 Notion</button>
        <div style="height:100px;"></div>
    </div>`;
    c.appendChild(exp);loadExpenses();
}

function switchTab(i){
    document.querySelectorAll('.tab-btn').forEach((b,x)=>b.classList.toggle('active',x===i));
    document.querySelectorAll('.day-content').forEach((d,x)=>d.style.display=x===i?'block':'none');
}

function switchView(v,e){
    document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
    e.classList.add('active');
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById('view-'+v).classList.add('active');
    document.getElementById('dayTabs').style.display=v==='itinerary'?'flex':'none';
}

const EXCHANGE_RATE=0.0242;
function addExpense(){
    const d=document.getElementById('exp-desc').value.trim(),a=document.getElementById('exp-amount').value;
    if(!d||!a) return alert('請輸入完整資訊');
    let list=JSON.parse(localStorage.getItem('seoul_expenses')||'[]');
    list.push({desc:d,amount:parseInt(a),date:new Date().toLocaleDateString()});
    localStorage.setItem('seoul_expenses',JSON.stringify(list));
    document.getElementById('exp-desc').value=''; document.getElementById('exp-amount').value='';
    loadExpenses();
}
function loadExpenses(){
    const list=document.getElementById('expense-list'),krw=document.getElementById('total-krw'),twd=document.getElementById('total-twd');
    if(!list) return;
    const data=JSON.parse(localStorage.getItem('seoul_expenses')||'[]');
    list.innerHTML=''; let total=0;
    data.forEach(e=>{
        total+=e.amount;
        const li=document.createElement('li'); li.className='expense-item';
        li.innerHTML=`<div><div style="font-size:1rem;font-weight:500;">${e.desc}</div><div style="font-size:0.75rem;color:#aaa;">${e.date}</div></div>
                      <div style="text-align:right;"><div style="font-weight:600;">₩${e.amount.toLocaleString()}</div>
                      <div style="font-size:0.8rem;color:#5b6c7d;">≈ NT$${Math.round(e.amount*EXCHANGE_RATE).toLocaleString()}</div></div>`;
        list.appendChild(li);
    });
    krw.innerText=total.toLocaleString(); twd.innerText=Math.round(total*EXCHANGE_RATE).toLocaleString();
}
function copyExpenses(){
    const data=JSON.parse(localStorage.getItem('seoul_expenses')||'[]');
    let txt="日期\t項目\t金額(KRW)\t約合(TWD)\n";
    data.forEach(e=>{txt+=`${e.date}\t${e.desc}\t${e.amount}\t${Math.round(e.amount*EXCHANGE_RATE)}\n`;});
    navigator.clipboard.writeText(txt).then(()=>alert('已複製！直接貼到 Notion'));
}

window.onload=renderItinerary;
</script>
</body>
</html>
